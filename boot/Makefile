D=../
ALL=boothead.bin
include $Dbeg.mak

kmzsiz.inc: $Dkern/kernel.bin
	@echo '; $@: Automaticly generated by Makefile, DO NOT modify me!' > $@
	@#@echo KMSIZ equ `size $< | awk '{if (NR == 2) print $$4}'` >> $@
	@#@echo KZSIZ equ `size $< | awk '{if (NR == 2) print $$3}'` >> $@
	@echo KFSIZ equ `ls -l $< | awk '{print $$5}'` >> $@
	@echo KZSIZ equ `size $(<:%.bin=%.sys) | awk '{if (NR == 2) print $$3}'` >> $@
	@echo KMSIZ equ '(KFSIZ+KZSIZ)' >> $@

boot.asm head.asm: boot.inc kmzsiz.inc

boothead.bin: boot.bin head.bin
ifdef WIN
	copy /b boot.bin+head.bin $@
else
	cat $^ > $@
endif

include $Dend.mak
